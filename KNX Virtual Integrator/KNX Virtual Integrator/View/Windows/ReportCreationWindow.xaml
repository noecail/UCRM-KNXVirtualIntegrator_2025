<mah:MetroWindow x:Class="KNX_Virtual_Integrator.View.Windows.ReportCreationWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
                 xmlns:viewmodel="clr-namespace:KNX_Virtual_Integrator.ViewModel"
                 d:DataContext="{d:DesignInstance Type=viewmodel:MainViewModel}"
                 mc:Ignorable="d"
                 Title="{DynamicResource ReportWindowTitle}" Height="500" Width="515"
                 TitleCharacterCasing="Normal"
                 ResizeMode="NoResize"
                 Background="{StaticResource WhiteBackgroundBrush}"
                 BorderThickness="1.5"
                 BorderBrush="{StaticResource KnxGreenBrush}"
                 WindowTitleBrush="{StaticResource KnxGreenBrush}"
                 NonActiveWindowTitleBrush="{StaticResource KnxLightGreenBrush}"
                 Closing="ClosingReportCreationWindow">
    
    <Window.Resources>
        <!-- ************************ Style pour les boutons en bas de la fenêtre ************************ -->
        <Style x:Key="BottomButtonLight" TargetType="Button" BasedOn="{StaticResource BaseButtonStyle}">
            <Setter Property="Background" Value="{StaticResource WhiteBackgroundBrush}" />
            <Setter Property="FocusVisualStyle" Value="{x:Null}" />
            <Setter Property="Padding" Value="5" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource LightGrayMouseOverBrush}" />
                                <Setter Property="Foreground" Value="{StaticResource LightForegroundBrush}" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#a8a8a8" />
                                <Setter Property="Foreground" Value="{StaticResource LightForegroundBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ReSharper disable once Xaml.RedundantResource -->
        <Style x:Key="BottomButtonDark" TargetType="Button" BasedOn="{StaticResource BaseButtonStyle}">
            <Setter Property="Background" Value="{StaticResource DarkGrayBackgroundBrush}" />
            <Setter Property="FocusVisualStyle" Value="{x:Null}" />
            <Setter Property="Padding" Value="5" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#434343" />
                                <Setter Property="Foreground" Value="{StaticResource DarkForegroundBrush}" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#313131" />
                                <Setter Property="Foreground" Value="{StaticResource DarkForegroundBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!-- ScrollViewer qui contient tout le contenu pour que le scaling n'entasse pas tout -->
    <ScrollViewer VerticalScrollBarVisibility="Disabled"
                  HorizontalScrollBarVisibility="Auto"
                  Background="{StaticResource NoColorBrush}">
        <Grid x:Name="ReportCreationWindowBorder" VerticalAlignment="Top">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"></RowDefinition> <!-- En-tête de la fenêtre (caché) -->
                <RowDefinition Height="*"></RowDefinition> <!-- Contenu principal avec la génération -->
                <RowDefinition Height="Auto"></RowDefinition> <!-- Boutons du bas -->
            </Grid.RowDefinitions>
            
            <!-- En-tête de la fenêtre (caché car redondant avec la bordure de la fenêtre) -->
            <Viewbox Grid.Row="0" HorizontalAlignment="Left" MouseLeftButtonDown="Header_MouseLeftButtonDown" Visibility="Collapsed">
                <StackPanel Orientation="Vertical" Background="{StaticResource NoColorBrush}" Width="500" Margin="0">
                    <!-- Icône + titre paramètres -->
                    <StackPanel Orientation="Horizontal">
                        <Image x:Name="PdfImageReport" Height="30" Width="30"
                               Margin="14,10,5,0"
                               VerticalAlignment="Center"
                               Source="{StaticResource PdfCreationImageLight}" />

                        <TextBlock x:Name="ReportWindowTopTitle"
                                   Text="{DynamicResource TestGenerationTitle}"
                                   Style="{StaticResource TitleTextLight}" FontSize="22"
                                   Margin="0, 12, 0, 0" />
                    </StackPanel>

                    <!-- Trait de séparation -->
                    <Path x:Name="HeaderPath" Stroke="#D7D7D7" StrokeThickness="2">
                        <Path.Data>
                            <LineGeometry StartPoint="15,10" EndPoint="485,10" />
                        </Path.Data>
                    </Path>
                </StackPanel>
            </Viewbox>
            
            <!-- ScrollViewer qui contient tout le contenu pour que le scaling n'entasse pas tout -->
            <ScrollViewer  Grid.Row="1" VerticalScrollBarVisibility="Visible"
                          Background="{StaticResource NoColorBrush}"
                          Margin="10">
                <StackPanel Orientation="Vertical" VerticalAlignment="Top">
                    <TextBlock x:Name="DocParamTextTitle"
                               Text="{DynamicResource DocParametersTitle}"
                               Style="{StaticResource TitleTextLight}"
                               Margin="10,10,0,0" />

                    <TextBlock x:Name="ReportAuthorText"
                               Text="{DynamicResource AuthorReport}"
                               Style="{StaticResource StandardTextBlockLight}"
                               Margin="10,10,10,2" />

                    <TextBox x:Name="AuthorNameTextBox"
                             Style="{StaticResource StandardTextBoxLight}"
                             Text="{Binding AuthorName}"
                             Width="400"
                             Margin="10, 5, 10, 10" />

                    <Grid>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                            <TextBlock x:Name="ReportPathTextBlock"
                                       Text="{DynamicResource ReportPath}"
                                       Style="{StaticResource StandardTextBlockLight}"
                                       HorizontalAlignment="Left"
                                       Margin="10,10,10,5" />
                        </StackPanel>
                        <StackPanel HorizontalAlignment="Right" VerticalAlignment="Bottom">
                            <Button Name="SetPdfPathButton"
                                    VerticalAlignment="Bottom"
                                    VerticalContentAlignment="Bottom"
                                    Style="{StaticResource ImportKeysButtonLight}"
                                    Click="SetPdfPathButton_OnClick"
                                    Margin="10,5,10,5">
                                <TextBlock Text="{DynamicResource ReportFullPath}"
                                           Width="125"
                                           FontSize="10"
                                           TextAlignment="Center"
                                           VerticalAlignment="Center" />
                            </Button>
                        </StackPanel>
                    </Grid>

                    <TextBlock x:Name="PdfPathText"
                               Style="{StaticResource StandardTextBlockLight}"
                               TextWrapping="Wrap"
                               Width="400"
                               Height="40"
                               Margin="10, 5, 10, 5" />

                    <!-- APERCU DU PDF AVEC WEBVIEWER -->
                    <TextBlock x:Name="ReportPreviewText"
                               Text="{DynamicResource ReportPreview}"
                               Style="{StaticResource StandardTextBlockLight}"
                               Margin="10,5,10,10" />
                    <WebBrowser x:Name="MyBrowser" Visibility="Hidden"></WebBrowser>
                </StackPanel>
            </ScrollViewer>
            
            <!-- Partie basse de la fenêtre (boutons sauvegarder et annuler) -->
            <StackPanel Grid.Row="2" x:Name="ReportWindowFooter" Orientation="Vertical" Margin="0,5,0,0"
                        Background="{StaticResource WhiteBackgroundBrush}">

                <!-- Trait de séparation -->
                <Path x:Name="FooterPath" Stroke="{StaticResource GrayBorderBrush}" StrokeThickness="2">
                    <Path.Data>
                        <LineGeometry StartPoint="15,10" EndPoint="485,10" />
                    </Path.Data>
                </Path>

                <!-- Bouton de sauvegarde et d'annulation -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,5,10,5">

                    <!-- Bouton save -->
                    <Button x:Name="SaveButton" Margin="0,0,15,0" Height="32"
                            Style="{StaticResource BottomButtonLight}"
                            Click="SaveButtonClick" Visibility="Visible">
                        <StackPanel Orientation="Horizontal">
                            <Image x:Name="GenerateRepImage"
                                   Width="20" Height="20" Margin="5,0,5,0" VerticalAlignment="Center"
                                   Source="{StaticResource CheckmarkLight}" />
                            <TextBlock x:Name="SaveButtonText" Text="{DynamicResource GenerationButton}"
                                       Style="{StaticResource StandardTextBlockLight}"
                                       FontSize="16"
                                       HorizontalAlignment="Center" Margin="5,0,5,0" />
                        </StackPanel>
                    </Button>

                    <!-- Bouton cancel -->
                    <Button x:Name="CancelButton" Margin="15,0,0,0" Height="32"
                            Style="{StaticResource BottomButtonLight}"
                            Click="CancelButtonClick" Visibility="Visible">
                        <StackPanel Orientation="Horizontal">
                            <Image x:Name="CancelRepImage" Width="16" Height="16" Margin="5,0,5,0"
                                   VerticalAlignment="Center"
                                   Source="{StaticResource CrossmarkLight}" />
                            <TextBlock x:Name="CancelButtonText" Text="{DynamicResource CancelButton}"
                                       FontWeight="Regular"
                                       Style="{StaticResource StandardTextBlockLight}"
                                       FontSize="16"
                                       HorizontalAlignment="Center" Margin="5,0,5,0" />
                        </StackPanel>
                    </Button>
                </StackPanel>
            </StackPanel>
        </Grid>
    </ScrollViewer>
</mah:MetroWindow>