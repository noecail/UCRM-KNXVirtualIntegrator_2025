<mah:MetroWindow x:Class="KNX_Virtual_Integrator.View.Windows.TestConfigWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
        xmlns:viewmodel="clr-namespace:KNX_Virtual_Integrator.ViewModel"
        xmlns:entities="clr-namespace:KNX_Virtual_Integrator.Model.Entities"
        d:DataContext="{d:DesignInstance Type=viewmodel:MainViewModel}"
        mc:Ignorable="d"
        Title="Configuration du test" Height="700" Width="1200"
        TitleCharacterCasing="Normal"
        ResizeMode="NoResize"
        Background="{StaticResource WhiteBackgroundBrush}"
        BorderThickness="2"
        BorderBrush="{StaticResource KnxGreenBrush}"
        WindowTitleBrush="{StaticResource KnxGreenBrush}"
        NonActiveWindowTitleBrush="{StaticResource KnxLightGreenBrush}"
        Closing="ClosingTestConfigWindow">
    
    <Window.Resources>
        
        <!-- Style pour les Modèles Fonctionnels choisis -->
        <DataTemplate x:Key="ListBoxItemLight" DataType="{x:Type entities:FunctionalModel}">
            <TextBlock Name="InterfaceItemsText" Text="{Binding Path=Name}"
                       Style="{StaticResource ItalicTextBlockLight}" />
        </DataTemplate>

        <DataTemplate x:Key="ListBoxItemDark" DataType="{x:Type entities:FunctionalModel}">
            <TextBlock Name="InterfaceItemsText" Text="{Binding Path=Name}"
                       Style="{StaticResource ItalicTextBlockDark}" />
        </DataTemplate>
        
        <!-- ReSharper disable once Xaml.RedundantResource -->
        <Style x:Key="ListBoxStyleDark" TargetType="ListBox" BasedOn="{StaticResource StandardListBoxDark}">
            <Setter Property="Background" Value="{StaticResource DarkGrayBackgroundBrush}"/> 
        </Style>
        
        <Style x:Key="LaunchTestButtonStyleLight" TargetType="Button" BasedOn="{StaticResource IconTextButtonStyle}">
            <Setter Property="Background" Value="{StaticResource GrayBackgroundBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource DarkGrayBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource DarkForegroundBrush}"/>
            <Setter Property="BorderThickness" Value=" 1"/>
        </Style>
        
        <!-- ReSharper disable once Xaml.RedundantResource -->
        <Style x:Key="LaunchTestButtonStyleDark" TargetType="Button" BasedOn="{StaticResource IconTextButtonStyle}">
            <Setter Property="Background" Value="{StaticResource BlueBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource DarkForegroundBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource LightGrayBorderBrush}"/>
            <Setter Property="BorderThickness" Value=" 1"/>
        </Style>
        
        
    </Window.Resources>
    
    
    
    
    
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition MinWidth="850" Width="Auto"/>
            <ColumnDefinition MinWidth="250" Width="*"/>
        </Grid.ColumnDefinitions>
        
        
        
        <Border Grid.Column="0" Name="AllModelsAndElementsColumn"
                Style="{StaticResource BorderLight}"
                BorderThickness="0,0,1,0">
            
            <Grid><!-- Define rows and columns for the nested grid -->
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />  <!-- Titres  -->
                    <RowDefinition Height="*" />     <!-- Contenu -->
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250" /> <!-- Modèles -->
                    <ColumnDefinition MinWidth="200" Width="Auto"/>
                    <ColumnDefinition MinWidth="200" Width="Auto"/> 
                </Grid.ColumnDefinitions>
            
            
                    <!-- Première colonne
                    Bibliothèque des Structures de Modèle Fonctionnel
                    Contient toutes les Structures de Modèle Fonctionnel (çàd non instanciées), prédéfinies ou crées (ou suggérées (IA))
                    ex : Structure de Modèle Fonctionnel pour les lampes
                    -->
                    
                    <!-- En-tête colonne 1 -->
                    <Border Grid.Row="0" Grid.Column="0"
                            x:Name="BorderStructBib"
                            Style="{StaticResource BorderLight}"
                            BorderThickness="0,0,1,1">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" /> <!-- Titre avec son icon-->
                                <ColumnDefinition Width="Auto" /> <!--Bouton de recherche-->
                            </Grid.ColumnDefinitions>

                        <!-- Bandeau supérieur -->
                        <StackPanel Grid.Column="0"
                                    Background="{StaticResource NoColorBrush}" 
                                    Orientation="Horizontal" 
                                    HorizontalAlignment="Center" 
                                    VerticalAlignment="Center" 
                                    Margin="10,0">
                            <Image Source="{StaticResource LibraryDrawingImage}" Height="20"/>
                            <TextBlock x:Name="StructBibTitleText"
                                       Style="{StaticResource TitleTextLight}"
                                       Text="{StaticResource Library}"
                            />
                        </StackPanel>

                        <!-- Bouton de recherche,(Non-implémenté)-->
                        <Button Grid.Column="1"
                                x:Name="SearchDefStructButton"
                                HorizontalAlignment="Right"
                                Style="{StaticResource SearchButtonLight}"
                                BorderThickness="1"
                                Margin="5"
                                Padding="5"
                                Height="30"
                        />
                    </Grid>
                </Border>
                    
                <!-- Contenu colonne 1 : liste des Structures de Modèles Fonctionnels : prédéfinis, créés et suggérés -->
                <Border Grid.Row="1" Grid.Column="0"
                        x:Name="BorderAllStruct"
                        Style="{StaticResource BorderLight}"
                        BorderThickness="0,0,1,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>      <!-- Titre des modèles prédéfinis-->
                            <RowDefinition Height="*"/>         <!-- Liste des modèles prédéfinis-->
                            <RowDefinition Height="Auto"/>      <!-- Titre des modèles créés-->
                            <RowDefinition Height="*"/>         <!-- Liste des modèles créés-->
                            <RowDefinition Height="Auto"/>      <!-- Bouton d'ajout de Structures de Modèles Fonctionnels-->
                        </Grid.RowDefinitions>

                        <!-- Titre Structures prédéfinies-->
                        <Border Grid.Row="0"  
                                x:Name="BorderDefStructTitle"
                                Style="{StaticResource BorderTitleLight}"
                                BorderThickness="0,0,0,2"
                                Padding="5">
                            <TextBlock x:Name="BorderDefStructTitleText"
                                       Style="{StaticResource TitleTextLight}"
                                       Text="{StaticResource PredefinedStructures}"
                            />
                        </Border>

                        <!-- Liste des Structures prédéfinies-->
                        <ScrollViewer x:Name="PredefinedStructuresScrollViewer" Grid.Row="1" 
                                      VerticalScrollBarVisibility="Visible" HorizontalScrollBarVisibility="Visible">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                
                                <ListBox Grid.Row="0"
                                         x:Name="DefStructureBox"
                                         ItemsSource="{Binding Structures}"
                                         SelectedItem="{Binding SelectedStructure,Mode=TwoWay}"
                                         ItemContainerStyle="{StaticResource ModelListBoxItemStyleLight}">
                                </ListBox>
                                
                                <!-- Bordure qui se place en dessous de la liste, dans l'espace restant. Sert à appliquer le fond et la bordure contre la scrollbar-->
                                <Border Grid.Row="1"
                                        x:Name="BorderDefStruct"
                                        Style="{StaticResource BorderLight}"
                                        BorderThickness="0,0,1,0">
                                </Border>
                            </Grid>
                        </ScrollViewer>

                        <!-- Titre des Structures créées-->
                        <Border Grid.Row="2"  
                                x:Name="BorderStructTitle"
                                Style="{StaticResource BorderTitleLight}"
                                BorderThickness="0,1,0,2"
                                Padding="5">
                                <TextBlock x:Name="BorderStructTitleText"
                                           Style="{StaticResource TitleTextLight}"
                                           Text="{StaticResource PersonalizedStructures}"
                                />
                        </Border>
                            
                        <!-- Listes des structures créées-->
                        <ScrollViewer Grid.Row="3"  
                                      VerticalScrollBarVisibility="Visible" HorizontalScrollBarVisibility="Visible">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                
                                <ListBox Grid.Row="0" 
                                         x:Name="StructureBox"
                                         ItemsSource="{Binding Structures}"
                                         SelectedItem="{Binding SelectedModel}"
                                         FontStyle="Italic"
                                         ItemContainerStyle="{StaticResource ModelListBoxItemStyleLight}">
                                </ListBox>
                                
                                <!-- Bordure qui se place en dessous de la liste, dans l'espace restant. Sert à appliquer le fond et la bordure contre la scrollbar-->
                                <Border Grid.Row="1"
                                        x:Name="BorderStruct"
                                        Style="{StaticResource BorderLight}"
                                        BorderThickness="0,0,1,0">
                                </Border>
                            </Grid>
                        </ScrollViewer>
                    </Grid>
                </Border>
                
                    <!-- Deuxième colonne
                    Liste des Modèles Fonctionnels correspondant à la Structure Sélectionnée
                    Contient tous les Modèles Fonctionnels qui ont été créés à partir de la Structure sélectionnée
                    ex : tous les Modèles Fonctionnels pour toutes les lampes de l'installation
                    -->

                    <!-- En-tête colonne 2-->
                    <Border Grid.Row="0" Grid.Column="1" 
                            x:Name="BorderModelBib"
                            Style="{StaticResource BorderLight}"
                            BorderThickness="0,0,1,1">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" /> <!-- Titre avec son icon-->
                                <ColumnDefinition Width="Auto" /> <!--Bouton de recherche-->
                            </Grid.ColumnDefinitions>

                        <StackPanel Background="{StaticResource NoColorBrush}" Orientation="Horizontal" Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="10,0">
                            <Image Source="{StaticResource FunctionalModelDrawingImage}" Height="20"/>
                            <TextBlock x:Name="ModelBibText"
                                       Style="{StaticResource TitleTextLight}"
                                       Text="{StaticResource ModelsTitle}"
                            />
                        </StackPanel>

                        <!-- Bouton de recherche,(Non-implémenté)-->
                        <Button Grid.Column="1"
                                x:Name="SearchModelButton"
                                HorizontalAlignment="Right"
                                Style="{StaticResource SearchButtonLight}"
                                BorderThickness="1"
                                Margin="5"
                                Padding="5"
                                Height="30"
                        />
                    </Grid>
                </Border>
                    
                <!-- Contenu colonne 2 : liste des Modèles Fonctionnels correspondant à la Structure sélectionnée-->
                <Border Grid.Row="1" Grid.Column="1"
                        x:Name="BorderAllModels"
                        Style="{StaticResource BorderLight}"
                        BorderThickness="0,0,1,0">
                    
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/> <!-- Titre structure -->
                            <RowDefinition Height="*" /><!-- Listes modèles-->
                        </Grid.RowDefinitions>

                        <!-- Titre Structure-->
                        <Border Grid.Row="0"  
                                x:Name="BorderModelTitle"
                                Style="{StaticResource BorderTitleLight}"
                                BorderThickness="0,0,0,2"
                                Padding="5">
                            
                            <TextBlock Style="{StaticResource TitleTextLight}"
                                       x:Name="BorderModelsTitleText"
                                       Text="{Binding SelectedStructure.Name}"
                            />
                        </Border>

                        <!-- Listes Modèles Fonctionnels liés-->
                        <ScrollViewer Grid.Row="1" x:Name="FunctionalModelsScrollViewer" VerticalScrollBarVisibility="Visible" HorizontalScrollBarVisibility="Disabled">
                            <Grid>    
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/> <!--Liste des Modèles Fonctionnels-->
                                    <RowDefinition Height="Auto"/> <!--Bouton d'ajout de Modèle Fonctionnel-->
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                
                                <ListBox Grid.Row="0" 
                                         x:Name="ModelsBox"
                                         ItemsSource="{Binding SelectedModels}"
                                         SelectedItem="{Binding SelectedModel, Mode=TwoWay}"
                                         ItemContainerStyle="{StaticResource ModelListBoxItemStyleLight}">
                                </ListBox>
                                
                                <!-- Bordure qui se place en dessous de la liste, dans l'espace restant. Sert à appliquer le fond et la bordure contre la scrollbar-->
                                <Border Grid.Row="2"
                                        x:Name="BorderModels"
                                        Style="{StaticResource BorderLight}"
                                        BorderThickness="0,0,1,0">
                                </Border>
                            </Grid>
                        </ScrollViewer>
                    </Grid>
                </Border>
            
            </Grid>
        </Border>
        
        
        <Border Grid.Column="1" Name="ChosenModelsColumn"
                Style="{StaticResource BorderTitleLight}"
                BorderThickness="1,0,0,0">
            
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition MinHeight="25" Height="Auto"/>       <!-- Titre Modèles Fonctionnels sélectionnés-->
                    <RowDefinition MinHeight="400" Height="*"/>         <!-- TextBox avec les modèles -->
                    <RowDefinition Height="Auto"/>                      <!-- Bouton de Lancement de Tests-->
                </Grid.RowDefinitions>
                
                <TextBlock 
                    Name="ChosenTestModelesTitle"
                    Style="{StaticResource TitleTextLight}"
                    FontSize="17"
                    HorizontalAlignment="Center"
                    Text="Modèles Fonctionnels Choisis"
                />
                
                <ListBox Grid.Row="1" Name="ChosenTestModelesListBox" Width="200" Height="320"
                         Style="{StaticResource StandardListBoxLight}"
                         ItemsSource="{Binding SelectedModels}"
                         SelectedItem="{Binding SelectedModel}"
                         SelectionMode="Single"
                         ItemContainerStyle="{StaticResource ListBoxContainerLight}"
                         ItemTemplate="{StaticResource ListBoxItemLight}">
                    <!-- ItemTemplate pour afficher les données -->
                </ListBox>
                
                <Button Grid.Row="2" Name="LaunchTestButton"
                        Content="Lancer le test"
                        Style="{StaticResource LaunchTestButtonStyleLight}"
                        Tag="{StaticResource PlayDrawingImage}"
                        Margin="7,7"
                        VerticalAlignment="Bottom"
                        HorizontalAlignment="Right"
                        MinHeight="50"
                />
                
                
            </Grid>
        </Border>
        
        
    </Grid>
    
    
</mah:MetroWindow>
